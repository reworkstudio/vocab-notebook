<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–°–ª–æ–≤–Ω–∏—á–æ–∫ / Vocabulary</title>
  <style>
    /* --- –¢–µ–º–∏ --- */
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      background: var(--bg-color);
      color: var(--text-color);
      transition: background 0.3s, color 0.3s;
    }
    :root {
      --bg-color: #e6f0ff;
      --text-color: #222;
      --header-bg: #005ce6;
      --header-color: white;
      --section-bg: white;
      --entry-bg: #f1f8ff;
      --button-bg: #005ce6;
      --button-hover-bg: #0041b3;
      --delete-btn-bg: #e60000;
      --delete-btn-hover-bg: #b30000;
      --border-color: #ccc;
    }
    body.dark {
      --bg-color: #121212;
      --text-color: #e1e1e1;
      --header-bg: #003399;
      --header-color: #eee;
      --section-bg: #1e1e1e;
      --entry-bg: #2a2a2a;
      --button-bg: #0041b3;
      --button-hover-bg: #002880;
      --delete-btn-bg: #b30000;
      --delete-btn-hover-bg: #7a0000;
      --border-color: #555;
    }

    header {
      background: var(--header-bg);
      color: var(--header-color);
      padding: 1rem;
      text-align: center;
      font-size: 1.5rem;
    }
    .container {
      max-width: 700px;
      margin: auto;
      padding: 1rem;
    }
    h2 {
      color: var(--header-bg);
    }
    input, button, select {
      width: 100%;
      margin: 0.3rem 0;
      padding: 0.6rem;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 1rem;
      background: var(--section-bg);
      color: var(--text-color);
    }
    button {
      background-color: var(--button-bg);
      color: white;
      cursor: pointer;
      transition: 0.2s;
    }
    button:hover {
      background-color: var(--button-hover-bg);
    }
    .section {
      background: var(--section-bg);
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    body.dark .section {
      box-shadow: 0 0 10px rgba(255,255,255,0.1);
    }
    .entry {
      background: var(--entry-bg);
      padding: 0.8rem;
      border-radius: 8px;
      margin: 0.5rem 0;
      position: relative;
      color: var(--text-color);
    }
    .entry-buttons {
      position: absolute;
      right: 0.5rem;
      top: 0.5rem;
      display: flex;
      gap: 0.25rem;
    }
    .delete-btn {
      background: var(--delete-btn-bg);
      color: white;
      border: none;
      padding: 0.4rem 0.6rem;
      border-radius: 6px;
    }
    .delete-btn:hover {
      background: var(--delete-btn-hover-bg);
    }

    /* –î–ª—è –ø–µ—Ä–µ–º–∏–∫–∞—á–∞ –º–æ–≤–∏ —ñ —Ç–µ–º–∏ */
    #controls {
      max-width: 700px;
      margin: 1rem auto;
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      align-items: center;
    }
    #controls select {
      width: auto;
      flex: 1;
    }
    #controls button {
      flex: 1;
      margin: 0;
    }
  </style>
</head>
<body>
  <header id="headerTitle">üåç –ú—ñ–π –°–ª–æ–≤–Ω–∏—á–æ–∫</header>

  <div id="controls" class="container">
    <select id="languageSelect" onchange="changeLanguage()">
      <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
      <option value="en">English</option>
    </select>
    <button id="themeToggleBtn" onclick="toggleTheme()">–¢–µ–º–Ω–∞ —Ç–µ–º–∞</button>
  </div>

  <div class="container">
    <div class="section">
      <h2 id="catTitle">1. –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó</h2>
      <input id="categoryInput" placeholder="–ù–æ–≤–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è" />
      <button onclick="addCategory()" id="addCatBtn">‚ûï –î–æ–¥–∞—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</button>
      <select id="categorySelect" onchange="changeCategory()"></select>
      <button onclick="deleteCategory()" id="delCatBtn" style="background:#e60000;margin-top:0.5rem">üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</button>
    </div>

    <div class="section" id="subcategoryBlock" style="display:none">
      <h2 id="subcatTitle">2. –ü—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</h2>
      <input id="subcategoryInput" placeholder="–ù–æ–≤–∞ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—è" />
      <button onclick="addSubcategory()" id="addSubcatBtn">‚ûï –î–æ–¥–∞—Ç–∏ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—é</button>
      <select id="subcategorySelect" onchange="changeSubcategory()"></select>
      <button onclick="deleteSubcategory()" id="delSubcatBtn" style="background:#e60000;margin-top:0.5rem">üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—é</button>
    </div>

    <div class="section" id="entryBlock" style="display:none">
      <h2 id="entryTitle">3. –î–æ–¥–∞—Ç–∏ —Ñ—Ä–∞–∑—É</h2>
      <input id="originalInput" placeholder="–§—Ä–∞–∑–∞ –æ—Ä–∏–≥—ñ–Ω–∞–ª–æ–º" />
      <input id="readingInput" placeholder="–Ø–∫ —á–∏—Ç–∞—î—Ç—å—Å—è" />
      <input id="translationInput" placeholder="–ü–µ—Ä–µ–∫–ª–∞–¥ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é" />
      <button onclick="addEntry()" id="addEntryBtn">üí¨ –î–æ–¥–∞—Ç–∏ —Ñ—Ä–∞–∑—É</button>
      <div id="entries"></div>
    </div>
  </div>

  <script>
    let data = JSON.parse(localStorage.getItem('vocabData') || '{}');
    let currentCategory = null;
    let currentSubcategory = null;

    const categorySelect = document.getElementById('categorySelect');
    const subcategorySelect = document.getElementById('subcategorySelect');
    const entriesDiv = document.getElementById('entries');

    const languageSelect = document.getElementById('languageSelect');
    const themeToggleBtn = document.getElementById('themeToggleBtn');

    // –ü–µ—Ä–µ–∫–ª–∞–¥–∏ —Ç–µ–∫—Å—Ç—ñ–≤
    const translations = {
      uk: {
        headerTitle: "üåç –ú—ñ–π –°–ª–æ–≤–Ω–∏—á–æ–∫",
        catTitle: "1. –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó",
        categoryInputPlaceholder: "–ù–æ–≤–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è",
        addCatBtn: "‚ûï –î–æ–¥–∞—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é",
        delCatBtn: "üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é",
        subcatTitle: "2. –ü—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—ó",
        subcategoryInputPlaceholder: "–ù–æ–≤–∞ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—è",
        addSubcatBtn: "‚ûï –î–æ–¥–∞—Ç–∏ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—é",
        delSubcatBtn: "üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—é",
        entryTitle: "3. –î–æ–¥–∞—Ç–∏ —Ñ—Ä–∞–∑—É",
        originalInputPlaceholder: "–§—Ä–∞–∑–∞ –æ—Ä–∏–≥—ñ–Ω–∞–ª–æ–º",
        readingInputPlaceholder: "–Ø–∫ —á–∏—Ç–∞—î—Ç—å—Å—è",
        translationInputPlaceholder: "–ü–µ—Ä–µ–∫–ª–∞–¥ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é",
        addEntryBtn: "üí¨ –î–æ–¥–∞—Ç–∏ —Ñ—Ä–∞–∑—É",
        deleteConfirmEntry: "–í–∏–¥–∞–ª–∏—Ç–∏ —Ü—é —Ñ—Ä–∞–∑—É?",
        deleteConfirmCategory: "–í–∏–¥–∞–ª–∏—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é",
        deleteConfirmSubcategory: "–í–∏–¥–∞–ª–∏—Ç–∏ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—é",
        categorySelectDefault: "–û–±–µ—Ä—ñ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—é",
        subcategorySelectDefault: "–û–±–µ—Ä—ñ—Ç—å –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—é",
        themeDark: "–¢–µ–º–Ω–∞ —Ç–µ–º–∞",
        themeLight: "–°–≤—ñ—Ç–ª–∞ —Ç–µ–º–∞",
      },
      en: {
        headerTitle: "üåç My Vocabulary",
        catTitle: "1. Categories",
        categoryInputPlaceholder: "New category",
        addCatBtn: "‚ûï Add category",
        delCatBtn: "üóëÔ∏è Delete category",
        subcatTitle: "2. Subcategories",
        subcategoryInputPlaceholder: "New subcategory",
        addSubcatBtn: "‚ûï Add subcategory",
        delSubcatBtn: "üóëÔ∏è Delete subcategory",
        entryTitle: "3. Add phrase",
        originalInputPlaceholder: "Original phrase",
        readingInputPlaceholder: "How to read",
        translationInputPlaceholder: "Translation (Ukrainian)",
        addEntryBtn: "üí¨ Add phrase",
        deleteConfirmEntry: "Delete this phrase?",
        deleteConfirmCategory: "Delete category",
        deleteConfirmSubcategory: "Delete subcategory",
        categorySelectDefault: "Select category",
        subcategorySelectDefault: "Select subcategory",
        themeDark: "Dark theme",
        themeLight: "Light theme",
      }
    };

    // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –º–æ–≤–∏ —ñ —Ç–µ–º–∏
    function loadSettings() {
      const lang = localStorage.getItem('lang') || 'uk';
      languageSelect.value = lang;
      applyLanguage(lang);

      const theme = localStorage.getItem('theme') || 'light';
      if (theme === 'dark') {
        document.body.classList.add('dark');
        themeToggleBtn.textContent = translations[lang].themeLight;
      } else {
        document.body.classList.remove('dark');
        themeToggleBtn.textContent = translations[lang].themeDark;
      }
    }

    function saveSettings() {
      localStorage.setItem('lang', languageSelect.value);
      localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
    }

    // –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º–æ–≤—É
    function applyLanguage(lang) {
      const t = translations[lang];
      document.getElementById('headerTitle').textContent = t.headerTitle;
      document.getElementById('catTitle').textContent = t.catTitle;
      document.getElementById('categoryInput').placeholder = t.categoryInputPlaceholder;
      document.getElementById('addCatBtn').textContent = t.addCatBtn;
      document.getElementById('delCatBtn').textContent = t.delCatBtn;
      document.getElementById('subcatTitle').textContent = t.subcatTitle;
      document.getElementById('subcategoryInput').placeholder = t.subcategoryInputPlaceholder;
      document.getElementById('addSubcatBtn').textContent = t.addSubcatBtn;
      document.getElementById('delSubcatBtn').textContent = t.delSubcatBtn;
      document.getElementById('entryTitle').textContent = t.entryTitle;
      document.getElementById('originalInput').placeholder = t.originalInputPlaceholder;
      document.getElementById('readingInput').placeholder = t.readingInputPlaceholder;
      document.getElementById('translationInput').placeholder = t.translationInputPlaceholder;
      document.getElementById('addEntryBtn').textContent = t.addEntryBtn;

      // –û–Ω–æ–≤–∏—Ç–∏ default –æ–ø—Ü—ñ—ó —Å–µ–ª–µ–∫—Ç—ñ–≤
      refreshCategories();
      if (currentCategory) {
        categorySelect.value = currentCategory;
        refreshSubcategories();
        if (currentSubcategory) {
          subcategorySelect.value = currentSubcategory;
        }
      }
    }

    // –ó–º—ñ–Ω–∞ –º–æ–≤–∏ –∑ —Å–µ–ª–µ–∫—Ç—É
    function changeLanguage() {
      const lang = languageSelect.value;
      applyLanguage(lang);
      saveSettings();
    }

    // –ü–µ—Ä–µ–º–∏–∫–∞—á —Ç–µ–º–∏
    function toggleTheme() {
      const lang = languageSelect.value;
      if (document.body.classList.contains('dark')) {
        document.body.classList.remove('dark');
        themeToggleBtn.textContent = translations[lang].themeDark;
      } else {
        document.body.classList.add('dark');
        themeToggleBtn.textContent = translations[lang].themeLight;
      }
      saveSettings();
    }

    // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —Å–ª–æ–≤–Ω–∏–∫–∞
    function save() {
      localStorage.setItem('vocabData', JSON.stringify(data));
    }

    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É –∫–∞—Ç–µ–≥–æ—Ä—ñ–π
    function refreshCategories() {
      const t = translations[languageSelect.value];
      categorySelect.innerHTML = `<option disabled selected>${t.categorySelectDefault}</option>`;
      Object.keys(data).forEach(cat => {
        const opt = document.createElement('option');
        opt.value = cat;
        opt.textContent = cat;
        categorySelect.appendChild(opt);
      });
    }

    // –ó–º—ñ–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
    function changeCategory() {
      currentCategory = categorySelect.value;
      document.getElementById('subcategoryBlock').style.display = 'block';
      refreshSubcategories();
    }

    // –î–æ–¥–∞—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é
    function addCategory() {
      const name = document.getElementById('categoryInput').value.trim();
      if (!name) return alert("Please enter a category name.");
      if (data[name]) return alert("Category already exists.");
      data[name] = {};
      save();
      refreshCategories();
      document.getElementById('categoryInput').value = '';
    }

    // –í–∏–¥–∞–ª–∏—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é
    function deleteCategory() {
      if (!currentCategory) return alert("Please select a category first.");
      const t = translations[languageSelect.value];
      if (confirm(`${t.deleteConfirmCategory} "${currentCategory}"?`)) {
        delete data[currentCategory];
        save();
        location.reload();
      }
    }

    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ–π
    function refreshSubcategories() {
      const t = translations[languageSelect.value];
      subcategorySelect.innerHTML = `<option disabled selected>${t.subcategorySelectDefault}</option>`;
      Object.keys(data[currentCategory] || {}).forEach(sub => {
        const opt = document.createElement('option');
        opt.value = sub;
        opt.textContent = sub;
        subcategorySelect.appendChild(opt);
      });
    }

    // –ó–º—ñ–Ω–∞ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
    function changeSubcategory() {
      currentSubcategory = subcategorySelect.value;
      document.getElementById('entryBlock').style.display = 'block';
      renderEntries();
    }

    // –î–æ–¥–∞—Ç–∏ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—é
    function addSubcategory() {
      const name = document.getElementById('subcategoryInput').value.trim();
      if (!name) return alert("Please enter a subcategory name.");
      if (data[currentCategory][name]) return alert("Subcategory already exists.");
      data[currentCategory][name] = [];
      save();
      refreshSubcategories();
      document.getElementById('subcategoryInput').value = '';
    }

    // –í–∏–¥–∞–ª–∏—Ç–∏ –ø—ñ–¥–∫–∞—Ç–µ–≥–æ—Ä—ñ—é
    function deleteSubcategory() {
      if (!currentSubcategory) return alert("Please select a subcategory first.");
      const t = translations[languageSelect.value];
      if (confirm(`${t.deleteConfirmSubcategory} "${currentSubcategory}"?`)) {
        delete data[currentCategory][currentSubcategory];
        save();
        location.reload();
      }
    }

    // –î–æ–¥–∞—Ç–∏ —Ñ—Ä–∞–∑—É
    function addEntry() {
      const original = document.getElementById('originalInput').value.trim();
      const reading = document.getElementById('readingInput').value.trim();
      const translation = document.getElementById('translationInput').value.trim();
      if (!original || !reading || !translation) {
        alert("Please fill all fields.");
        return;
      }
      data[currentCategory][currentSubcategory].push({ original, reading, translation });
      save();
      document.getElementById('originalInput').value = '';
      document.getElementById('readingInput').value = '';
      document.getElementById('translationInput').value = '';
      renderEntries();
    }

    // –í—ñ–¥–º–∞–ª—é–≤–∞—Ç–∏ —Ñ—Ä–∞–∑–∏
    function renderEntries() {
      entriesDiv.innerHTML = '';
      const list = data[currentCategory][currentSubcategory];
      list.forEach((e, i) => {
        const div = document.createElement('div');
        div.className = 'entry';
        div.innerHTML = `
          <div><b>${languageSelect.value === 'uk' ? '–§—Ä–∞–∑–∞' : 'Phrase'}:</b> <span contenteditable onblur="updateEntry(${i}, this.innerText, 'original')">${e.original}</span></div>
          <div><b>${languageSelect.value === 'uk' ? '–Ø–∫ —á–∏—Ç–∞—Ç–∏' : 'Reading'}:</b> <span contenteditable onblur="updateEntry(${i}, this.innerText, 'reading')">${e.reading}</span></div>
          <div><b>${languageSelect.value === 'uk' ? '–ü–µ—Ä–µ–∫–ª–∞–¥' : 'Translation'}:</b> <span contenteditable onblur="updateEntry(${i}, this.innerText, 'translation')">${e.translation}</span></div>
          <div class="entry-buttons">
            <button class="delete-btn" onclick="deleteEntry(${i})">‚úï</button>
          </div>
        `;
        entriesDiv.appendChild(div);
      });
    }

    // –û–Ω–æ–≤–∏—Ç–∏ —Ñ—Ä–∞–∑—É
    function updateEntry(index, newValue, field) {
      data[currentCategory][currentSubcategory][index][field] = newValue.trim();
      save();
    }

    // –í–∏–¥–∞–ª–∏—Ç–∏ —Ñ—Ä–∞–∑—É
    function deleteEntry(index) {
      const t = translations[languageSelect.value];
      if (confirm(t.deleteConfirmEntry)) {
        data[currentCategory][currentSubcategory].splice(index, 1);
        save();
        renderEntries();
      }
    }

    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
    loadSettings();

    // –°–ø–µ—Ä—à—É –æ–Ω–æ–≤–ª—é—î–º–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó, —â–æ–± –Ω–µ –±—É–ª–æ –ø–æ—Ä–æ–∂–Ω—å–æ
    refreshCategories();

  </script>
</body>
</html>
